{% extends "user/index.html" %}
{% block title %} {{ super() }}{% endblock title %}

{% block head %}
    {{ super() }}
    <link rel="stylesheet" type="text/css" media="screen" href={{ url_for('static', filename='css/bootstrap-datetimepicker.min.css') }} />
    <script src={{ url_for('static', filename='js/bootstrap-datetimepicker.min.js') }}></script>
    <script src={{ url_for('static', filename='js/bootstrap-datetimepicker.zh-CN.js') }}></script>
    <script>
      $(document).ready(function() {
          $('#startdt').datetimepicker({
              minView: "month", //选择日期后，不会再跳转去选择时分秒
              format: "yyyy-mm-dd", //选择日期后，文本框显示的日期格式
              language: 'zh-CN', //汉化
              // startDate : new Date(),
              todayBtn: true,
              autoclose:true //选择日期后自动关闭
          });
          $('#enddt').datetimepicker({
              minView: "month", //选择日期后，不会再跳转去选择时分秒
              format: "yyyy-mm-dd", //选择日期后，文本框显示的日期格式
              language: 'zh-CN', //汉化
              // startDate : new Date(),
              todayBtn: true,
              autoclose:true //选择日期后自动关闭
          });

          $('._one_report_item').each(function() {
              $(this).click(function() {
                  var date = $(this).find('input').first().val();
                  window.open('/{{session.appname}}/user/report/staffopreport/daily/detail?date=' + date);
              });
          });
      });
    </script>
{% endblock head %}

{% block right_content %}
    <div class='.container-fluid'>
        <div class='row' style="margin: 0">
            <div class='col-md-12' style="padding: 0">
                 <form  id='query-form' class="form-inline" action={{ '/%s/user/report/staffopreport/daily/query' % session.appname }} method='post'>
                    <input type="hidden" name='next_page' id='next_page' value={{form.next_page or 1}} />
                    <img src="{{session.user.avatar}}" style="width: 30px;" />
                    {{session.user.name or session.user.nickname}}的日报
                    <input type="text" id="startdt" name="startdt" class="form-control" value="{{ form.startdt or '' }}" placeholder="起始日期">
                    <input type="text" id="enddt" name="enddt" class="form-control" value="{{ form.enddt or '' }}" placeholder="结束日期">
                    <div class="form-group">
                        <div>
                          <button type="submit" class="btn btn-success">查询</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <div clas='row' style='margin-top: 20px;'>
            <div class='col-md-12' style="padding-left: 0">
                <table class="table table-bordered table-condensed table-hover" style="min-width: 1280px">
                  <tbody>
                      <tr style="background-color: gray; color: white;">
                        <th style="width: 100px;">日期</th>
                        <th>活跃次数(今日)</th>
                        <th>活跃次数(累计)</th>
                        <th>亚报告(今日创建数)</th>
                        <th>亚报告(累计总数)</th>
                        <th>亚报告(今日用户数)</th>
                        <th>亚报告(累计用户数)</th>
                      </tr>
                      {# 遍历展示用户列表 #}
                      {% for report in reports %}
                      <tr class='_one_report_item'>
                        <input type='hidden' value="{{report.date}}" />
                        <td style="color: #fafafa; background-color: #{{('%s00' % (report.date[0:4]|int * report.date[5:7]|int * report.date[8:10]|int))[0:6]}}">{{report.date}}</td>
                        <td style="color: #008B45">{{report.activecount_delta}}</td>
                        <td style="color: #008B45">{{report.activecount}}</td>
                        <td style="color: #00868B">{{report.falylogcount_create_delta}}</td>
                        <td style="color: #00868B">{{report.falylogcount}}</td>
                        <td style="color: #00868B">{{report.falylogusercount_delta}}</td>
                        <td style="color: #00868B">{{report.falylogusercount}}</td>
                      </td>
                      {% endfor %}
                  </tbody>
                </table>
                共{{total_pages}}页，共{{total_count}}条
                <div class=row>
                    <div class='col-md-12'>
                        <nav>
                          <ul class="pager">
                            {% if page > 1 %}
                            <li><a href="#" id='to_previous_page'>上一页</a></li>
                            {% endif %}
                            <li>{{page or 1}}</li>
                            {% if page < total_pages %}
                            <li><a href="#" id='to_next_page'>下一页</a></li>
                            {% endif %}
                          </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock right_content %}
